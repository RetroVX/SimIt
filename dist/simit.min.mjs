const _Pact=function(){function _Pact(){}return _Pact.prototype.then=function(onFulfilled,onRejected){const result=new _Pact,state=this.s;if(state){const callback=1&state?onFulfilled:onRejected;if(callback){try{_settle(result,1,callback(this.v))}catch(e){_settle(result,2,e)}return result}return this}return this.o=function(_this){try{const value=_this.v;1&_this.s?_settle(result,1,onFulfilled?onFulfilled(value):value):onRejected?_settle(result,1,onRejected(value)):_settle(result,2,value)}catch(e){_settle(result,2,e)}},result},_Pact}();function _settle(pact,state,value){if(!pact.s){if(value instanceof _Pact){if(!value.s)return void(value.o=_settle.bind(null,pact,state));1&state&&(state=value.s),value=value.v}if(value&&value.then)return void value.then(_settle.bind(null,pact,state),_settle.bind(null,pact,2));pact.s=state,pact.v=value;const observer=pact.o;observer&&observer(pact)}}function _isSettledPact(thenable){return thenable instanceof _Pact&&1&thenable.s}function _forTo(array,body,check){var i=-1,pact,reject;function _cycle(result){try{for(;++i<array.length&&(!check||!check());)if((result=body(i))&&result.then){if(!_isSettledPact(result))return void result.then(_cycle,reject||(reject=_settle.bind(null,pact=new _Pact,2)));result=result.v}pact?_settle(pact,1,result):pact=result}catch(e){_settle(pact||(pact=new _Pact),2,e)}}return _cycle(),pact}const _iteratorSymbol="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function _forOf(target,body,check){if("function"==typeof target[_iteratorSymbol]){var iterator=target[_iteratorSymbol](),step,pact,reject;function _cycle(result){try{for(;!((step=iterator.next()).done||check&&check());)if((result=body(step.value))&&result.then){if(!_isSettledPact(result))return void result.then(_cycle,reject||(reject=_settle.bind(null,pact=new _Pact,2)));result=result.v}pact?_settle(pact,1,result):pact=result}catch(e){_settle(pact||(pact=new _Pact),2,e)}}if(_cycle(),iterator.return){var _fixup=function(value){try{step.done||iterator.return()}catch(e){}return value};if(pact&&pact.then)return pact.then(_fixup,(function(e){throw _fixup(e)}));_fixup()}return pact}if(!("length"in target))throw new TypeError("Object is not iterable");for(var values=[],i=0;i<target.length;i++)values.push(target[i]);return _forTo(values,(function(i){return body(values[i])}),check)}const _asyncIteratorSymbol="undefined"!=typeof Symbol?Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")):"@@asyncIterator";function _for(test,update,body){for(var stage;;){var shouldContinue=test();if(_isSettledPact(shouldContinue)&&(shouldContinue=shouldContinue.v),!shouldContinue)return result;if(shouldContinue.then){stage=0;break}var result=body();if(result&&result.then){if(!_isSettledPact(result)){stage=1;break}result=result.s}if(update){var updateValue=update();if(updateValue&&updateValue.then&&!_isSettledPact(updateValue)){stage=2;break}}}var pact=new _Pact,reject=_settle.bind(null,pact,2);return(0===stage?shouldContinue.then(_resumeAfterTest):1===stage?result.then(_resumeAfterBody):updateValue.then(_resumeAfterUpdate)).then(void 0,reject),pact;function _resumeAfterBody(value){result=value;do{if(update&&(updateValue=update())&&updateValue.then&&!_isSettledPact(updateValue))return void updateValue.then(_resumeAfterUpdate).then(void 0,reject);if(!(shouldContinue=test())||_isSettledPact(shouldContinue)&&!shouldContinue.v)return void _settle(pact,1,result);if(shouldContinue.then)return void shouldContinue.then(_resumeAfterTest).then(void 0,reject);_isSettledPact(result=body())&&(result=result.v)}while(!result||!result.then);result.then(_resumeAfterBody).then(void 0,reject)}function _resumeAfterTest(shouldContinue){shouldContinue?(result=body())&&result.then?result.then(_resumeAfterBody).then(void 0,reject):_resumeAfterBody(result):_settle(pact,1,result)}function _resumeAfterUpdate(){(shouldContinue=test())?shouldContinue.then?shouldContinue.then(_resumeAfterTest).then(void 0,reject):_resumeAfterTest(shouldContinue):_settle(pact,1,result)}}var SimIt=function SimIt(element){this.element=element||window||document};SimIt.prototype.all=function all(sequence,onStart,onComplete){try{var _this=this;null==onStart&&(onStart=function(){}),null==onComplete&&(onComplete=function(){}),onStart(sequence);var length=sequence.length,stepCounter=0,_temp=_forOf(sequence,(function(step){return stepCounter++,Promise.resolve(_this._checkEvent(step)).then((function(){stepCounter===length&&onComplete(sequence)}))}));return Promise.resolve(_temp&&_temp.then?_temp.then((function(){})):void 0)}catch(e){return Promise.reject(e)}},SimIt.prototype.repeat=function repeat(step,amount,delay){try{var _this2=this;null==amount&&(amount=1),null==delay&&(delay=0);var i=0,_temp2=_for((function(){return i<amount}),(function(){return i++}),(function(){return Promise.resolve(_this2.sleep(delay)).then((function(){return Promise.resolve(_this2._checkEvent(step)).then((function(){}))}))}));return Promise.resolve(_temp2&&_temp2.then?_temp2.then((function(){})):void 0)}catch(e){return Promise.reject(e)}},SimIt.prototype.sleep=function sleep(ms){return new Promise((function(resolve){return setTimeout(resolve,ms)}))},SimIt.prototype.click=function click(x,y){return this.element.dispatchEvent(new MouseEvent("click",{clientX:x||0,clientY:y||0}))},SimIt.prototype.keydown=function keydown(key){return this.element.dispatchEvent(new KeyboardEvent("keydown",{key:key||void 0}))},SimIt.prototype.keyup=function keyup(key){return this.element.dispatchEvent(new KeyboardEvent("keyup",{key:key||void 0}))},SimIt.prototype.keypress=function keypress(key){return this.element.dispatchEvent(new KeyboardEvent("keypress",{key:key||void 0}))},SimIt.prototype.setElement=function setElement(element){return this.element=element,this},SimIt.prototype._checkEvent=function _checkEvent(obj){try{var _this3=this,_temp9=function(){if(obj.keydown)_this3.keydown(obj.keydown);else{var _temp8=function(){if(obj.keyup)_this3.keyup(obj.keyup);else{var _temp7=function(){if(obj.keypress)_this3.keypress(obj.keypress);else{var _temp6=function(){if(obj.click)_this3.click(obj.click.x,obj.click.y);else{var _temp5=function(){if(obj.sleep)return Promise.resolve(_this3.sleep(obj.sleep)).then((function(){}));var _temp4=function(){if(obj.callback)return Promise.resolve(obj.callback()).then((function(){}));var _temp3=function(){if(obj.repeat)return Promise.resolve(_this3.repeat(obj.repeat.event,obj.repeat.amount,obj.repeat.delay)).then((function(){}))}();return _temp3&&_temp3.then?_temp3.then((function(){})):void 0}();return _temp4&&_temp4.then?_temp4.then((function(){})):void 0}();if(_temp5&&_temp5.then)return _temp5.then((function(){}))}}();if(_temp6&&_temp6.then)return _temp6.then((function(){}))}}();if(_temp7&&_temp7.then)return _temp7.then((function(){}))}}();if(_temp8&&_temp8.then)return _temp8.then((function(){}))}}();return Promise.resolve(_temp9&&_temp9.then?_temp9.then((function(){})):void 0)}catch(e){return Promise.reject(e)}};export default SimIt;